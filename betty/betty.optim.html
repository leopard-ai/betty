


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-PQBQ3CV');
  </script>
  <!-- End Google Tag Manager -->

  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="google-site-verification" content="okUst94cAlWSsUsGZTB4xSS4UKTtRV8Nu5XZ9pdd3Aw" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>betty.optim &mdash; Betty</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!-- <link rel="stylesheet" href="../_static/pygments.css" type="text/css" /> -->
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="betty.logging package" href="betty.logging.html" />
    <link rel="prev" title="betty.hypergradient" href="betty.hypergradient.html" />
  <!-- Google Analytics -->
  
  <!-- End Google Analytics -->
  

  
  <script src="../_static/js/modernizr.min.js"></script>

  <!-- Preload the theme fonts -->

<link rel="preload" href="../_static/fonts/FreightSans/freight-sans-book.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/FreightSans/freight-sans-medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/IBMPlexMono/IBMPlexMono-Medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/FreightSans/freight-sans-bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/FreightSans/freight-sans-medium-italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/IBMPlexMono/IBMPlexMono-SemiBold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/UCity/UCity-Light.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/UCity/UCity-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/UCity/UCity-Semibold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/Inconsolata/Inconsolata.woff2" as="font" type="font/woff2" crossorigin="anonymous">

<!-- Preload the katex fonts -->

<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Math-Italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size1-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size4-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size2-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size3-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Caligraphic-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <script defer src="https://use.fontawesome.com/releases/v6.1.1/js/all.js" integrity="sha384-xBXmu0dk1bEoiwd71wOonQLyH+VpgR1XcDH3rtxrLww5ajNTuMvBdL5SOiFZnNdp" crossorigin="anonymous"></script>
</head>

<div class="container-fluid header-holder tutorials-header" id="header-holder">
  <div class="container">
    <div class="header-container">
      <a class="header-logo" href="https://leopard-ai.github.io/betty" aria-label="PyTorch Lightning">
      <!--  <img class="call-to-action-img" src="../_static/images/logo-lightning-icon.png"/> -->
      </a>

      <div class="main-menu">
        <ul>
          <li>
            <a href="https://leopard-ai.github.io/betty">Docs</a>
          </li>

          <li>
            <a href="https://github.com/leopard-ai/betty">GitHub</a>
          </li>

        </ul>
      </div>

      <a class="main-menu-open-button" href="#" data-behavior="open-mobile-menu"></a>
    </div>
  </div>
</div>

<body class="pytorch-body">

   

    

    <div class="table-of-contents-link-wrapper">
      <span>Table of Contents</span>
      <a href="#" class="toggle-table-of-contents" data-behavior="toggle-table-of-contents"></a>
    </div>

    <nav data-toggle="wy-nav-shift" class="pytorch-left-menu" id="pytorch-left-menu">
      <div class="pytorch-side-scroll">
        <div class="pytorch-menu pytorch-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          <div class="pytorch-left-menu-search">
            

            
              
              
            

            


  


<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search Docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

            
          </div>

          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Get Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../quickstart/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart/concept.html">Major Concepts</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/basic/basic.html">Basic</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/intermediate/intermediate.html">Intermediate</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Docs</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="betty.engine.html">betty.engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="betty.problems.html">betty.problems</a></li>
<li class="toctree-l1"><a class="reference internal" href="betty.hypergradient.html">betty.hypergradient</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">betty.optim</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#betty.optim.patch_optimizer"><code class="docutils literal notranslate"><span class="pre">patch_optimizer()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#betty.optim.patch_scheduler"><code class="docutils literal notranslate"><span class="pre">patch_scheduler()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#supported-optimizers">Supported optimizers</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="betty.logging.html">betty.logging</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../examples/data_reweighting.html">Data Reweighting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/maml.html">Model-Agnostic Meta-Learning (MAML)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/neural_architecture_search.html">Neural Architecture Search</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <div class="pytorch-container">
      <div class="pytorch-page-level-bar" id="pytorch-page-level-bar">
        <div class="pytorch-breadcrumbs-wrapper">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="pytorch-breadcrumbs">
    
      <li>
        <a href="../index.html">
          
            Docs
          
        </a> &gt;
      </li>

        
      <li>betty.optim</li>
    
    
      <li class="pytorch-breadcrumbs-aside">
        
            
            <a href="../_sources/betty/betty.optim.rst.txt" rel="nofollow"><img src="../_static/images/view-page-source-icon.svg"></a>
          
        
      </li>
    
  </ul>

  
</div>
        </div>

        <div class="pytorch-shortcuts-wrapper" id="pytorch-shortcuts-wrapper">
          Shortcuts
        </div>
      </div>

      <section data-toggle="wy-nav-shift" id="pytorch-content-wrap" class="pytorch-content-wrap">
        <div class="pytorch-content-left">

        
          
          <div class="rst-content">
          
            <div role="main" class="main-content" itemscope="itemscope" itemtype="http://schema.org/Article">
             <article itemprop="articleBody" id="pytorch-article" class="pytorch-article">
              
  <section id="betty-optim">
<h1>betty.optim<a class="headerlink" href="#betty-optim" title="Permalink to this heading">¶</a></h1>
<p>Iterative differentiation (ITD) differentiates through the optimization path, requiring
tracking of the intermediate states of the parameter during optimization. However, native
PyTorch optimizer overrides such intermediate states with the use of in-place operations for the
good purpose of saving memory. We here provide the functionality of patching PyTorch’s native
optimizers by substituting all involved in-place operations to allow ITD. When users pass
their optimizer to <code class="docutils literal notranslate"><span class="pre">IterativeProblem</span></code> class through the constructor, <code class="docutils literal notranslate"><span class="pre">initialize</span></code> method of
<code class="docutils literal notranslate"><span class="pre">IterativeProblem</span></code> will automatically call <code class="docutils literal notranslate"><span class="pre">patch_optimizer</span></code> and <code class="docutils literal notranslate"><span class="pre">patch_scheduler</span></code> to patch
user-proviced PyTorch native optimizer/scheduler along with stateful modules.</p>
<span class="target" id="module-betty.optim"></span><dl class="py function">
<dt class="sig sig-object py" id="betty.optim.patch_optimizer">
<span class="sig-prename descclassname"><span class="pre">betty.optim.</span></span><span class="sig-name descname"><span class="pre">patch_optimizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">module</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/betty/optim.html#patch_optimizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#betty.optim.patch_optimizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Patch PyTorch’s native optimizer by replacing all in-place operations in its <code class="docutils literal notranslate"><span class="pre">step</span></code> method</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>optimizer</strong> (<a class="reference external" href="https://pytorch.org/docs/stable/_modules/torch/optim/optimizer.html#Optimizer">torch.nn.optim.Optimizer</a>) – User-provided PyTorch’s native optimizer</p></li>
<li><p><strong>module</strong> (<a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Module.html?highlight=module#torch.nn.Module">torch.nn.Module</a>) – User-provided PyTorch module that is being optimized by the <code class="docutils literal notranslate"><span class="pre">optimizer</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Corresponding differentiable optimizer</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>DifferentiableOptimizer</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="betty.optim.patch_scheduler">
<span class="sig-prename descclassname"><span class="pre">betty.optim.</span></span><span class="sig-name descname"><span class="pre">patch_scheduler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">old_scheduler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_optimizer</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/betty/optim.html#patch_scheduler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#betty.optim.patch_scheduler" title="Permalink to this definition">¶</a></dt>
<dd><p>Patch the original learning rate scheduler to work with a patched differentiable optimizer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>old_scheduler</strong> (<a class="reference external" href="https://pytorch.org/docs/stable/optim.html?highlight=lr_scheduler">torch.optim.lr_scheduler</a>) – User-provided PyTorch’s learning rate scheduler</p></li>
<li><p><strong>new_optimizer</strong> (<em>DifferentiableOptimizer</em>) – Patched differentiable optimizer</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Patched learning rate scheduler</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><p><a class="reference external" href="https://pytorch.org/docs/stable/optim.html?highlight=lr_scheduler">torch.optim.lr_scheduler</a></p>
</p>
</dd>
</dl>
</dd></dl>

<section id="supported-optimizers">
<h2>Supported optimizers<a class="headerlink" href="#supported-optimizers" title="Permalink to this heading">¶</a></h2>
<p>Below is the list of differentiable optimizers supported by Betty.</p>
<span class="target" id="module-betty.optim.sgd"></span><dl class="py class">
<dt class="sig sig-object py" id="betty.optim.sgd.DifferentiableSGD">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">betty.optim.sgd.</span></span><span class="sig-name descname"><span class="pre">DifferentiableSGD</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">module</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/betty/optim/sgd.html#DifferentiableSGD"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#betty.optim.sgd.DifferentiableSGD" title="Permalink to this definition">¶</a></dt>
<dd><p>Differentiable version of PyTorch’s
<a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.optim.SGD.html#sgd">SGD</a> optimizer.
All in-place operations are replaced.</p>
</dd></dl>

<span class="target" id="module-betty.optim.adam"></span><dl class="py class">
<dt class="sig sig-object py" id="betty.optim.adam.DifferentiableAdam">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">betty.optim.adam.</span></span><span class="sig-name descname"><span class="pre">DifferentiableAdam</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">module</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/betty/optim/adam.html#DifferentiableAdam"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#betty.optim.adam.DifferentiableAdam" title="Permalink to this definition">¶</a></dt>
<dd><p>Differentiable version of PyTorch’s
<a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.optim.Adam.html#adam">Adam</a> optimizer.
All in-place operations are replaced.</p>
</dd></dl>

<span class="target" id="module-betty.optim.adamw"></span><dl class="py class">
<dt class="sig sig-object py" id="betty.optim.adamw.DifferentiableAdamW">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">betty.optim.adamw.</span></span><span class="sig-name descname"><span class="pre">DifferentiableAdamW</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">module</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/betty/optim/adamw.html#DifferentiableAdamW"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#betty.optim.adamw.DifferentiableAdamW" title="Permalink to this definition">¶</a></dt>
<dd><p>Differentiable version of PyTorch’s
<a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.optim.AdamW.html#adamw">AdamW</a> optimizer.
All in-place operations are replaced.</p>
</dd></dl>

</section>
</section>


             </article>
             
            </div>
            <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="betty.logging.html" class="btn btn-neutral float-right" title="betty.logging package" accesskey="n" rel="next">Next <img src="../_static/images/chevron-right-orange.svg" class="next-page"></a>
      
      
        <a href="betty.hypergradient.html" class="btn btn-neutral" title="betty.hypergradient" accesskey="p" rel="prev"><img src="../_static/images/chevron-right-orange.svg" class="previous-page"> Previous</a>
      
    </div>
  

  

    <hr>

  

  <div role="contentinfo">
    <p>
        &copy; Copyright 2022, sangkeun00.

    </p>
  </div>
    
      <div>
        Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
      </div>
     

</footer>

          </div>
        </div>

        <div class="pytorch-content-right" id="pytorch-content-right">
          <div class="pytorch-right-menu" id="pytorch-right-menu">
            <div class="pytorch-side-scroll" id="pytorch-side-scroll-right">
              <ul>
<li><a class="reference internal" href="#">betty.optim</a><ul>
<li><a class="reference internal" href="#betty.optim.patch_optimizer"><code class="docutils literal notranslate"><span class="pre">patch_optimizer()</span></code></a></li>
<li><a class="reference internal" href="#betty.optim.patch_scheduler"><code class="docutils literal notranslate"><span class="pre">patch_scheduler()</span></code></a></li>
<li><a class="reference internal" href="#supported-optimizers">Supported optimizers</a><ul>
<li><a class="reference internal" href="#betty.optim.sgd.DifferentiableSGD"><code class="docutils literal notranslate"><span class="pre">DifferentiableSGD</span></code></a></li>
<li><a class="reference internal" href="#betty.optim.adam.DifferentiableAdam"><code class="docutils literal notranslate"><span class="pre">DifferentiableAdam</span></code></a></li>
<li><a class="reference internal" href="#betty.optim.adamw.DifferentiableAdamW"><code class="docutils literal notranslate"><span class="pre">DifferentiableAdamW</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

            </div>
          </div>
        </div>
      </section>
    </div>

  


  

     
       <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
         <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
         <script src="../_static/doctools.js"></script>
         <script src="../_static/sphinx_highlight.js"></script>
     

  

  <script type="text/javascript" src="../_static/js/vendor/popper.min.js"></script>
  <script type="text/javascript" src="../_static/js/vendor/bootstrap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/list.js/1.5.0/list.min.js"></script>
  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

  <!-- Begin Footer -->

  <div class="container-fluid docs-tutorials-resources" id="docs-tutorials-resources">
    <div class="container">
      <div class="row">
      </div>
    </div>
  </div>

  <div class="cookie-banner-wrapper">
  <div class="container">
    <p class="gdpr-notice">To analyze traffic and optimize your experience, we serve cookies on this site. By clicking or navigating, you agree to allow our usage of cookies. Read PyTorch Lightning's <a href="https://pytorchlightning.ai/privacy-policy">Privacy Policy</a>.</p>
    <img class="close-button" src="../_static/images/pytorch-x.svg">
  </div>
</div>

  <!-- End Footer -->

  <!-- Begin Mobile Menu -->

  <div class="mobile-main-menu">
    <div class="container-fluid">
      <div class="container">
        <div class="mobile-main-menu-header-container">
          <a class="header-logo" href="https://leopard-ai.github.io/betty" aria-label="PyTorch Lightning"></a>
          <a class="main-menu-close-button" href="#" data-behavior="close-mobile-menu"></a>
        </div>
      </div>
    </div>

    <div class="mobile-main-menu-links-container">
      <div class="main-menu">
        <ul>
          <li>
            <a href="https://leopard-ai.github.io/betty">Docs</a>
          </li>

          <li>
            <a href="https://github.com/leopard-ai/betty">Github</a>
          </li>

        </ul>
      </div>
    </div>
  </div>

  <!-- End Mobile Menu -->

  <script type="text/javascript" src="../_static/js/vendor/anchor.min.js"></script>

  <script type="text/javascript">
    $(document).ready(function() {
      mobileMenu.bind();
      mobileTOC.bind();
      pytorchAnchors.bind();
      sideMenus.bind();
      scrollToAnchor.bind();
      highlightNavigation.bind();
      mainMenuDropdown.bind();
      filterTags.bind();

      // Add class to links that have code blocks, since we cannot create links in code blocks
      $("article.pytorch-article a span.pre").each(function(e) {
        $(this).closest("a").addClass("has-code");
      });
    })
  </script>

  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PQBQ3CV"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->
 </body>
</html>