Search.setIndex({"docnames": ["betty/betty.engine", "betty/betty.hypergradient", "betty/betty.logging", "betty/betty.optim", "betty/betty.problems", "examples/data_reweighting", "examples/maml", "examples/neural_architecture_search", "index", "quickstart/concept", "quickstart/concept_architecture", "quickstart/concept_autodiff", "quickstart/concept_mlo", "quickstart/concept_software", "quickstart/installation", "tutorial/basic/basic", "tutorial/basic/basic_logging", "tutorial/basic/basic_memory", "tutorial/basic/basic_start", "tutorial/basic/basic_validation", "tutorial/intermediate/intermediate", "tutorial/intermediate/intermediate_distributed", "tutorial/intermediate/intermediate_hypergradient"], "filenames": ["betty/betty.engine.rst", "betty/betty.hypergradient.rst", "betty/betty.logging.rst", "betty/betty.optim.rst", "betty/betty.problems.rst", "examples/data_reweighting.rst", "examples/maml.rst", "examples/neural_architecture_search.rst", "index.rst", "quickstart/concept.rst", "quickstart/concept_architecture.rst", "quickstart/concept_autodiff.rst", "quickstart/concept_mlo.rst", "quickstart/concept_software.rst", "quickstart/installation.rst", "tutorial/basic/basic.rst", "tutorial/basic/basic_logging.rst", "tutorial/basic/basic_memory.rst", "tutorial/basic/basic_start.rst", "tutorial/basic/basic_validation.rst", "tutorial/intermediate/intermediate.rst", "tutorial/intermediate/intermediate_distributed.rst", "tutorial/intermediate/intermediate_hypergradient.rst"], "titles": ["betty.engine", "betty.hypergradient", "betty.logging package", "betty.optim", "betty.problems", "Data Reweighting", "Implicit Model Agnostic Meta-Learning", "Neural Architecture Search", "Betty Documentation", "Major Concepts", "Architecture", "Autodiff for Multilevel Optimization", "Multilevel Optimization", "Software Design", "Installation", "Basic", "Logging", "Memory Optimization", "Quick Start", "Validation", "Intermediate", "Distributed Training", "Hypergradient"], "terms": {"unlik": [0, 1, 11, 13, 18, 19], "tradit": [0, 1, 11, 17, 19], "automat": [0, 1, 2, 3, 8, 9, 11, 13, 16, 18, 21, 22], "differenti": [0, 1, 3, 4, 8, 9, 11, 13, 18, 22], "techniqu": [0, 1, 11, 17], "calcul": [0, 1, 4, 5, 17, 18, 20, 22], "analyt": [0, 1, 11], "jacobian": [0, 1, 4, 13, 18, 22], "each": [0, 1, 4, 5, 6, 8, 11, 12, 13, 17, 18, 19], "oper": [0, 1, 3, 4, 11, 17, 22], "multilevel": [0, 1, 4, 8, 9, 13, 14, 16, 18, 19, 22], "optim": [0, 1, 4, 5, 6, 8, 9, 14, 16, 18, 19, 21, 22], "requir": [0, 1, 3, 4, 5, 6, 8, 9, 11, 13, 14, 21], "approxim": [0, 1, 4, 8, 11, 13], "best": [0, 1, 4, 5, 13, 18, 22], "respons": [0, 1, 4, 13, 18, 22], "level": [0, 1, 2, 4, 5, 8, 11, 12, 13, 17, 19, 22], "problem": [0, 1, 2, 6, 8, 11, 12, 14, 16, 17, 19, 22], "below": [0, 1, 3, 5, 6, 8, 13, 17, 18, 21], "i": [0, 1, 3, 4, 5, 6, 8, 9, 11, 12, 13, 16, 17, 18, 19, 21, 22], "list": [0, 1, 3, 4, 5, 17, 18], "ar": [0, 1, 3, 4, 5, 6, 11, 12, 13, 16, 18], "support": [0, 1, 2, 4, 11, 16, 17, 21], "class": [0, 2, 3, 4, 5, 6, 8, 13, 16, 17, 18, 19, 22], "config": [0, 1, 4, 5, 6, 13, 16, 17, 18, 19], "none": [0, 2, 4, 5, 6, 18], "depend": [0, 4, 5, 6, 8, 9, 11, 14, 18, 19, 21], "env": [0, 4, 6], "sourc": [0, 1, 2, 3, 4], "handl": [0, 5, 6, 8, 13, 18, 19], "dataflow": [0, 13], "graph": [0, 4, 13], "base": [0, 1, 4, 11, 13], "user": [0, 1, 2, 3, 4, 6, 8, 11, 13, 14, 16, 17, 18, 19, 21, 22], "provid": [0, 2, 3, 4, 5, 6, 8, 11, 13, 16, 18, 19, 21], "hierarch": [0, 4, 5, 8, 13], "It": [0, 4, 13], "also": [0, 4, 5, 6, 11, 13, 19, 21], "primit": 0, "execut": [0, 5, 6, 9, 11, 16, 18, 19], "check_leaf": 0, "check": [0, 4], "whether": [0, 4], "given": [0, 4, 5, 6, 11, 17, 18, 22], "leaf": [0, 4, 6], "paramet": [0, 1, 2, 3, 4, 5, 6, 11, 12, 13, 18, 22], "return": [0, 1, 3, 4, 5, 6, 13, 16, 17, 18, 22], "true": [0, 4, 6, 13, 17, 18], "fals": [0, 4, 17, 18], "type": [0, 1, 2, 3, 4, 5, 6, 11, 16, 17, 18, 21], "bool": [0, 4, 6], "do_valid": 0, "run": [0, 5, 6, 11, 14, 15, 16, 18, 19], "valid": [0, 2, 5, 6, 11, 15, 16, 18], "eval": [0, 4], "set": [0, 4, 5, 8, 11, 12, 17, 18, 21], "all": [0, 3, 4, 5, 8, 11, 13, 18], "mode": [0, 4, 11], "find_path": 0, "src": 0, "dst": 0, "find": [0, 11, 13], "path": [0, 3, 4, 11, 13, 14, 16, 18, 19], "from": [0, 1, 4, 5, 6, 8, 11, 12, 13, 14, 16, 17, 18, 19, 22], "modifi": [0, 1, 11, 13], "depth": [0, 11, 13], "first": [0, 5, 6, 11, 12, 13], "search": [0, 1, 8, 11, 12, 13], "algorithm": [0, 1, 4, 5, 6, 11, 13, 18, 22], "The": [0, 1, 5, 6, 11, 13, 17, 18], "end": [0, 5, 11, 12, 13, 22], "point": [0, 11], "upper": [0, 4, 5, 11, 12, 14, 16, 19, 22], "lower": [0, 1, 4, 5, 11, 12, 14, 16, 19, 22], "edg": [0, 11, 13], "start": [0, 4, 5, 11, 13, 15, 16, 17, 19], "initi": [0, 3, 4, 5, 6, 13, 14, 16, 18, 19], "comput": [0, 4, 11, 21], "between": [0, 5, 8, 11, 13, 18], "initialize_distribut": [], "distribut": [0, 4, 5, 17, 18, 20], "train": [0, 1, 2, 4, 5, 6, 11, 12, 13, 16, 18, 19, 20], "is_impl": [0, 4], "fn_name": [0, 4], "method": [0, 1, 2, 3, 4, 5, 6, 8, 11, 13, 18, 19, 22], "implement": [0, 1, 4, 5, 6, 8, 9, 11, 13, 16, 17, 18, 19, 22], "str": [0, 2], "name": [0, 2, 4, 5, 6, 14, 16, 18, 19], "is_rank_zero": [0, 4], "current": [0, 1, 2, 4, 11, 13, 16, 17, 18], "process": [0, 1, 4, 13, 18], "rank": [0, 4], "0": [0, 4, 5, 6, 14, 16, 17, 18, 19, 21], "parse_config": 0, "pars": 0, "engineconfig": [0, 5, 13, 16, 18, 19], "parse_depend": 0, "u2l": [0, 5, 6, 13, 18], "l2u": [0, 5, 6, 13, 18], "figur": [0, 8, 10, 11], "out": [0, 5, 6, 8, 16, 17, 18, 19], "1": [0, 4, 5, 6, 8, 11, 12, 14, 15, 16, 17, 18, 19, 20, 21], "topolog": [0, 11, 12], "order": [0, 4, 5, 6, 8, 11, 12, 21], "2": [0, 4, 5, 6, 10, 11, 12, 15, 17, 18, 20, 21], "backpropag": [0, 4, 11], "": [0, 1, 2, 3, 4, 5, 6, 8, 9, 12, 13, 14, 16, 18, 19, 21], "A": [0, 1, 11], "us": [0, 1, 3, 4, 6, 8, 9, 11, 13, 14, 15, 16, 17, 18, 21, 22], "gradient": [0, 4, 5, 6, 8, 13, 18, 21], "descent": [0, 1, 4, 11, 18], "set_depend": 0, "set_problem_attr": 0, "attribut": [0, 5, 6, 13, 18, 21], "train_step": [0, 2, 6], "one": [0, 4, 5, 12, 13, 17, 18, 21], "step": [0, 1, 2, 3, 4, 6, 11, 13, 14, 16, 18, 19], "dart": [1, 5, 6, 11, 12, 13, 16, 17, 18, 22], "vector": [1, 11, 22], "curr": [1, 22], "prev": [1, 22], "sync": 1, "matrix": [1, 11, 22], "multipl": [1, 6, 8, 11, 12, 13, 17, 21, 22], "more": [1, 4, 6, 8, 11, 12, 17, 18, 19, 21], "specif": [1, 4, 5, 6, 12, 16, 18, 19, 22], "we": [1, 3, 4, 5, 6, 8, 9, 11, 12, 13, 15, 16, 17, 18, 19, 21, 22], "propos": [1, 12, 18], "architectur": [1, 8, 9, 12], "re": [1, 5, 6, 18], "interpret": [1, 6], "implicit": [1, 8, 11, 13, 18], "perspect": 1, "empir": [1, 11, 13], "thi": [1, 4, 5, 6, 9, 11, 12, 13, 15, 16, 17, 18, 19], "achiev": [1, 4, 6, 11, 13, 18, 22], "better": [1, 11, 12, 13, 17], "memori": [1, 3, 4, 11, 13, 15, 21], "effici": [1, 4, 11, 13], "wall": [1, 11, 13], "time": [1, 11, 13, 14, 16, 18, 19, 22], "test": [1, 5, 6, 14, 18], "accuraci": [1, 2, 4, 5, 11, 13, 18], "other": [1, 4, 5, 6, 11, 18, 22], "sequenc": [1, 4, 12], "tensor": [1, 4], "which": [1, 4, 5, 11, 12, 13, 18, 19], "would": 1, "perform": [1, 4, 5, 8, 11, 17, 18, 19, 22], "directli": [1, 13, 17, 18], "intermedi": [1, 3, 4, 11, 17], "million": 1, "hyperparamet": [1, 8, 12], "function": [1, 3, 4, 5, 6, 11, 12, 18], "theorem": 1, "ift": 1, "mai": [1, 4, 11, 21], "specifi": [1, 2, 4, 5, 6, 13, 16, 18, 19], "learn": [1, 3, 5, 8, 12, 13, 15, 17, 18, 21], "rate": [1, 3, 5, 6, 13, 18], "neumann_alpha": 1, "unrol": [1, 4, 11, 18], "neumann_iter": 1, "cg": [1, 22], "pytorch": [1, 2, 3, 4, 8, 11, 13, 14, 21], "default": [1, 4, 11, 13, 19], "autograd": 1, "need": [1, 4, 5, 6, 8, 11, 13, 14, 16, 18, 21], "cg_alpha": 1, "iter": [1, 3, 8, 11, 13, 18, 22], "cg_iter": 1, "allow": [1, 3, 4, 6, 8, 9, 11, 13, 16, 22], "through": [1, 2, 3, 4, 5, 6, 9, 11, 13, 18], "non": [1, 17], "sampl": [1, 5, 6, 18], "ha": [1, 5, 11, 12, 13, 18, 21], "been": [1, 11, 12, 21], "complet": [1, 5, 11, 13], "yet": 1, "an": [2, 4, 5, 9, 11, 12, 13, 15, 16, 17, 18], "featur": [2, 13, 15, 21], "easili": [2, 17, 18], "track": [2, 3, 4, 5, 11], "loss": [2, 4, 5, 6, 14, 16, 18, 21], "etc": [2, 4, 6, 8], "can": [2, 4, 5, 6, 8, 11, 12, 13, 14, 16, 17, 18, 19, 21, 22], "metric": [2, 4, 13, 16], "engin": [2, 4, 8, 16, 19], "two": [2, 5, 6, 8, 11, 12, 13, 17, 18], "tensorboardlogg": 2, "wandblogg": 2, "logger_tensorboard": 2, "comment": [2, 5], "close": 2, "summarywrit": 2, "stat": [2, 4], "tag": 2, "dict": [2, 4], "dictoinari": 2, "valu": [2, 4, 5, 13, 18], "record": 2, "option": [2, 4, 5, 6, 16, 18], "data": [2, 4, 6, 8, 15, 16, 17, 18, 19, 21], "identifi": 2, "int": [2, 4, 6, 17, 18, 21], "associ": [2, 4, 13], "logger_wandb": 2, "weight": [2, 4, 5, 6, 12, 16, 18], "bias": [2, 16], "logger_bas": 2, "loggerbas": 2, "static": 2, "debug": 2, "msg": 2, "arg": [2, 4, 5, 6, 12, 21], "kwarg": [2, 4], "messag": 2, "global": [2, 4, 5, 14, 16, 19], "debugg": 2, "error": [2, 4, 13], "info": [2, 14, 16, 18, 19], "visual": [2, 8, 13], "e": [2, 4, 5, 6, 11, 12, 13, 14, 16, 17, 18, 20, 21], "g": [2, 4, 5, 6, 11, 13, 16, 17, 18, 20], "warn": 2, "get_logg": 2, "get": [2, 4, 6], "itd": [3, 4, 11, 13], "state": [3, 4, 6, 11, 17], "dure": [3, 11], "howev": [3, 11, 13, 14], "nativ": [3, 4, 11, 13, 21], "overrid": [3, 11], "place": [3, 4, 11], "good": 3, "purpos": 3, "save": [3, 16], "here": [3, 4, 5, 6, 8, 11, 12, 13, 18, 21], "patch": [3, 4, 11, 13, 21], "substitut": 3, "involv": [3, 4, 5, 9, 11, 13, 17, 18], "when": [3, 4, 5, 11, 12, 13, 16, 18], "pass": [3, 5, 13], "iterativeproblem": [3, 4, 6, 13, 14], "constructor": [3, 5, 6, 13, 18], "call": [3, 4, 5, 12, 13, 18], "patch_optim": [3, 4], "patch_schedul": [3, 4], "provic": 3, "schedul": [3, 4, 5, 6, 13, 18, 21], "along": [3, 5], "modul": [3, 4, 5, 6, 11, 17, 18, 21], "replac": [3, 4, 6, 11, 17, 19], "its": [3, 4, 5, 8, 11, 12, 18], "torch": [3, 4, 5, 6, 13, 16, 17, 18, 19, 21], "nn": [3, 4, 5, 13, 17, 18], "being": [3, 11], "correspond": [3, 11, 12, 13, 18, 22], "differentiableoptim": 3, "old_schedul": 3, "new_optim": 3, "origin": [3, 11], "work": [3, 4, 12], "lr_schedul": [3, 5, 6, 18], "sgd": [3, 5, 6, 18], "differentiablesgd": 3, "version": [3, 6, 21], "adam": [3, 5, 18], "differentiableadam": 3, "adamw": [3, 6], "differentiableadamw": 3, "train_data_load": [4, 13, 18], "devic": [0, 4, 5, 6, 13, 17, 18], "defin": [4, 6, 8, 12, 13, 18, 19], "constrain": [4, 12], "dataset": [4, 5, 6, 12, 17, 18], "configur": [0, 4, 5, 6, 16, 18, 21], "number": [4, 5, 8, 11, 18], "add_child": 4, "add": [4, 15, 22], "add_env": 4, "environ": 4, "add_logg": 4, "logger": [4, 13], "add_par": 4, "add_path": 4, "new": [4, 5, 6, 13, 22], "hypergradi": [4, 20], "backward": [4, 6, 21], "param": 4, "create_graph": 4, "retain_graph": [4, 6, 13], "allow_unus": 4, "respect": [4, 5, 11, 13, 16, 18], "output": [4, 5, 13, 14, 16, 18], "input": [4, 5, 6, 16, 18], "If": [4, 14, 16, 18, 19], "deriv": [4, 11], "construct": [4, 18], "higher": [4, 18], "product": [4, 5, 11], "grad": 4, "freed": 4, "note": [4, 5, 6, 21], "nearli": 4, "case": [4, 6, 12, 13], "often": [4, 13, 16, 19], "around": 4, "much": 4, "wai": [4, 6, 11, 13, 17], "were": 4, "therefor": [4, 6, 11, 12], "alwai": 4, "zero": [4, 6, 21], "abstract": [4, 8, 9, 13], "cache_st": 4, "cach": 4, "buffer": 4, "roll_back": [4, 5], "check_readi": 4, "readi": 4, "done": [4, 18], "onli": [4, 6, 8, 11, 12, 13, 16], "excut": [4, 18], "properti": 4, "children": 4, "clear_depend": 4, "clear": 4, "clip_grad": 4, "clip": [4, 13], "norm": 4, "configure_devic": 4, "configure_distributed_train": 4, "dictionari": [4, 5, 13, 16, 18], "python": [4, 5, 13, 14, 16, 18, 21, 22], "configure_roll_back": 4, "roll": 4, "back": 4, "warm": 4, "off": 4, "count": 4, "local": [4, 14, 16], "evalu": 4, "forward": [4, 5, 17, 18, 21], "how": [4, 6, 9, 12, 15, 16, 17, 18, 19], "get_batch": [4, 6], "load": [4, 6], "batch": [4, 5, 6, 13, 16, 17, 18], "loader": [4, 5, 6, 18, 21], "ani": [4, 8, 13, 18], "get_batch_single_load": 4, "idx": 4, "get_loss": 4, "log": [4, 13, 15], "classif": [4, 5, 13, 15, 18], "get_opt_param_group_for_param": 4, "param_group": 4, "inquir": 4, "get_opt_state_for_param": 4, "gradient_accumulation_boundari": 4, "accumul": [4, 6, 13], "boundari": 4, "up": [0, 4, 5, 13, 17, 21], "after": [4, 6, 18], "compil": [4, 13], "fp16": [4, 5, 13], "load_state_dict": [4, 6], "state_dict": [4, 6], "global_step": [4, 6], "self": [4, 5, 6, 13, 16, 17, 18, 19], "summari": 4, "on_epoch_end_exec": [], "one_step_desc": 4, "optimizer_step": 4, "updat": [4, 5, 6, 7, 10, 13, 18], "parent": [4, 6], "patch_module_optimizer_load": [], "lr": [4, 5, 6, 18, 21], "placement": [0, 4], "fsdp": [4, 21], "recover_st": 4, "recov": 4, "set_grad": 4, "trainabl": 4, "By": [4, 11], "includ": [4, 8, 11, 12, 14, 21], "scheuler": 4, "scaler": [4, 21], "four": [4, 11], "sub": [4, 9, 20], "cost": [4, 11, 12, 17], "3": [4, 5, 11, 14, 15, 16, 17, 18, 19, 21], "4": [4, 5, 6, 9, 11, 15, 17, 18, 21], "whole": [4, 5, 13, 19], "step_after_roll_back": 4, "step_norm": 4, "synchronize_param": 4, "synchron": 4, "across": [4, 11], "parallel": [4, 17, 21], "trainable_paramet": 4, "training_step": [4, 5, 6, 13, 16, 18], "training_step_exec": 4, "zero_grad": [4, 6], "similar": 4, "aid": [4, 11, 13], "doesn": 4, "t": [4, 12, 13, 16, 18], "usual": [4, 13], "especi": 4, "larg": [4, 11, 13, 17, 21], "recommend": [4, 13], "implicitproblem": [4, 5, 6, 13, 16, 18], "mlo": [4, 5, 6, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 22], "implicit_problem": 4, "sublass": 4, "flow": 4, "discourag": 4, "becaus": [4, 11], "oftentim": [4, 11, 13, 21], "wors": 4, "than": [4, 5, 11, 17, 18], "In": [4, 5, 6, 9, 11, 12, 13, 16, 17, 18, 19, 21, 22], "addit": [4, 6, 12, 13, 16, 18], "familiar": [4, 6], "program": [4, 5, 8, 9, 11, 12, 13, 15, 18, 19, 20, 22], "style": [4, 8], "due": [4, 11, 12, 13, 21], "stateless": 4, "iterative_problem": 4, "patch_modul": 4, "so": [4, 5, 12, 13, 18, 22], "take": [4, 5, 11, 13, 18, 21], "compat": 4, "meta": [5, 8, 12, 17, 18, 21], "net": [5, 18], "explicit": 5, "map": 5, "For": [5, 6, 8, 11, 12, 13, 16, 17, 22], "second": [5, 21], "These": 5, "follow": [5, 6, 11, 13, 14, 16, 18, 21, 22], "stage": [5, 13], "textbf": 5, "w": [5, 11, 18, 22], "classifi": [5, 16, 17, 19], "minim": 5, "while": [5, 6, 8, 11, 12, 13, 18], "impos": 5, "some": [5, 11, 17, 21], "let": [5, 18], "th": [5, 11, 18], "l_": [5, 18], "l": [5, 11, 12, 13, 18], "y_i": 5, "y_": 5, "predict": 5, "mathcal": [5, 11, 12, 13, 18, 22], "v": [5, 11, 22], "theta": [5, 12, 18], "object": [5, 13], "mathrm": [5, 11, 12, 18, 22], "argmin": [5, 11, 12, 18, 22], "frac": [5, 11, 18, 22], "n": [5, 11, 12, 18], "sum_": [5, 11, 18], "resnet32": 5, "y": 5, "_i": 5, "_": [5, 6, 11, 18], "m": [5, 21], "chosen": [5, 11], "mlp": [5, 18], "detail": [5, 8, 13, 21], "formul": [5, 9, 12, 13, 18], "see": [5, 14, 16, 18, 19, 22], "henc": [5, 11], "go": [5, 9, 12], "pipelin": [5, 12], "final": [5, 6, 11, 13, 16, 18], "differ": [5, 11, 13, 18], "three": [5, 17], "train_dataload": 5, "meta_dataload": 5, "have": [5, 6, 8, 12, 18], "test_dataload": [5, 16, 19], "our": [5, 6, 11, 13, 15, 16, 17, 18], "both": [5, 6, 11, 13, 16, 18], "now": [5, 8, 18], "help": 5, "import": [5, 6, 11, 12, 14, 17, 18, 21, 22], "librari": [5, 8], "code": [5, 6, 8, 17, 18], "block": [5, 17], "found": [5, 6, 12, 18, 21], "f": [5, 6, 16, 17, 18], "util": [5, 13, 18], "simpli": [5, 6, 8, 11, 18, 19, 21], "do": [5, 6, 8, 13, 18], "thing": [5, 8], "structur": [5, 8], "seven": 5, "compon": [5, 18], "5": [5, 18, 21], "6": [5, 14, 17, 18], "7": [5, 17], "via": [5, 6, 11, 14, 17, 18, 19, 21], "character": 5, "follw": 5, "assist": 5, "understand": [5, 12, 13], "suppos": 5, "subclass": [5, 19], "inner": [5, 6, 14, 16, 18, 19], "x": [5, 16, 17, 18, 19], "def": [5, 6, 13, 16, 17, 18, 19, 22], "contain": 5, "subset": 5, "label": [5, 6, 16, 17, 18], "cross": [5, 18], "entropi": [5, 18], "probelem": 5, "reshap": [5, 18], "loss_vector": [5, 18], "cross_entropi": [5, 6, 16, 18], "long": [5, 15, 16, 17, 18], "reduct": [5, 18], "loss_vector_reshap": [5, 18], "everi": [5, 11, 13], "access": [5, 6, 13, 18], "outer": [5, 6, 14], "detach": [5, 6, 18], "calcult": 5, "mean": [5, 6, 16, 17, 18], "indvidu": 5, "configure_train_data_load": 5, "configure_modul": 5, "cifar10": [5, 17], "10": [5, 6, 14, 17, 18, 21], "100": [5, 6, 13, 16, 17, 18, 19], "configure_optim": 5, "momentum": [5, 18], "dampen": 5, "weight_decai": 5, "nesterov": 5, "sepecif": 5, "configure_schedul": 5, "multisteplr": [5, 18], "mileston": [5, 18], "5000": [5, 13, 14], "7500": [5, 6], "9000": 5, "gamma": [5, 18], "made": [5, 11], "acc": [5, 6, 13, 16, 18, 19], "argmax": [5, 6, 16, 18, 19], "dim": [5, 6, 16, 18, 19], "float": [5, 6, 16], "item": [5, 6, 16, 18, 19], "form": 5, "meta_net": 5, "hidden_s": [5, 6], "meta_net_hidden_s": 5, "num_lay": 5, "meta_net_num_lay": 5, "meta_optim": 5, "meta_lr": 5, "meta_weight_decai": 5, "instanti": [5, 13, 18, 19], "porblem": 5, "make": 5, "difin": 5, "prooblem": 5, "relat": [5, 6], "outer_config": 5, "log_step": [5, 6, 16, 17], "inner_config": 5, "unroll_step": [5, 6, 18], "With": 5, "instansi": 5, "move": [5, 11], "where": [5, 6, 11, 12, 13, 18, 22], "kei": [5, 13], "node": [5, 11, 13, 21], "destin": [5, 11], "sinc": [5, 6, 11, 13, 18], "manag": [5, 13], "you": [5, 13, 14, 18], "within": [5, 9], "again": [5, 18], "best_acc": [5, 6, 16, 19], "reweightingengin": [5, 16, 19], "no_grad": [5, 13, 16, 19], "correct": [5, 16, 18, 19], "total": [5, 11, 13, 16, 18, 19], "thorugh": [5, 6], "target": [5, 16, 17, 18, 19], "desir": 5, "without": [5, 9, 13, 18, 22], "sum": [5, 6, 16, 18, 19], "size": [5, 6, 16, 17, 18, 19], "greater": 5, "previou": [5, 13], "setup": [5, 13, 21], "engine_config": [5, 6, 13, 16, 18, 19, 21], "train_it": [5, 13, 16, 18, 19, 21], "10000": [5, 16], "valid_step": [5, 13, 16, 19], "rollback": 5, "dictiontionari": 5, "print": [5, 13, 18, 19], "IF": 5, "imbalanced_factor": [5, 17, 18], "ening": 5, "onc": [5, 11, 13, 18, 21, 22], "complic": [5, 8], "intern": 5, "mechan": [5, 6, 11], "To": [6, 7, 10, 11, 12, 13, 14, 17, 18, 21], "gener": [8, 9, 11, 12, 15], "gml": 8, "unifi": [6, 8], "interfac": [8, 9, 13, 16, 22], "neural": [6, 8, 11, 12, 13, 19], "reweight": [8, 15, 16, 17, 19], "adversari": 8, "reinforc": [6, 8, 12, 22], "notori": 8, "exampl": [6, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21], "write": [8, 15, 18], "nest": [8, 12], "loop": [6, 8], "aim": [8, 12, 18], "awai": 8, "low": 8, "behind": [8, 21], "api": [8, 13], "high": [8, 11, 13], "declar": 8, "choos": [8, 11, 18], "carri": 8, "robust": 8, "wide": [8, 11, 12], "rang": [6, 8, 11, 12, 17, 18], "serach": 8, "sever": [8, 9, 11, 13], "refer": [8, 11, 12, 13, 18, 19], "domain": 8, "adapt": [6, 8], "pretrain": [8, 12], "finetun": [8, 12], "model": [8, 12, 17, 21], "agnost": 8, "abov": [6, 8, 11, 12, 13, 18, 21, 22], "tradition": 8, "distinct": 8, "common": [8, 11, 18], "autodiff": [8, 9, 13, 22], "routin": 8, "plan": 8, "futur": 8, "instal": 8, "tutori": [6, 8, 15, 17, 18, 19, 21], "illustr": [8, 9, 11, 12], "main": [8, 12], "concept": [8, 12, 13], "chapter": [9, 13, 18], "introduc": [9, 12, 13, 18], "betti": [6, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22], "softwar": [9, 18], "design": [6, 9, 18, 19], "easi": [9, 13, 16], "modular": [9, 13, 22], "maintain": [9, 13], "complex": [9, 11, 13], "expertis": 9, "mathemat": [9, 11, 12, 13], "compos": [9, 17, 18], "well": [9, 11, 13, 18], "applic": 9, "describ": [6, 9], "advanc": 9, "discuss": [9, 11, 13], "overal": [6, 9, 11, 19], "diagram": 10, "paper": 11, "focu": [6, 11], "particular": [11, 12, 18], "rather": [11, 12, 13, 17], "zeroth": 11, "like": [0, 11, 13, 18, 21], "bayesian": 11, "scale": [11, 13, 17, 21], "dimension": 11, "essenti": [11, 13, 16], "c": [11, 12, 13, 14, 22], "_k": [11, 12, 13], "theta_k": [11, 12, 13], "u": [11, 12, 13], "solv": [11, 12], "p_k": [11, 12], "theta_l": 11, "d": [11, 12, 13], "expand": 11, "chain": 11, "rule": 11, "begin": [6, 11, 12, 22], "flalign": [11, 12, 22], "textcolor": 11, "brown": 11, "underbrac": 11, "partial": [11, 22], "text": [11, 12, 18, 22], "direct": [6, 11], "blue": 11, "straightforward": [6, 11], "exist": [11, 12], "framework": [11, 12], "major": [11, 12], "difficulti": 11, "li": 11, "subsect": [11, 18], "enabl": [6, 11, 15, 16, 17, 21], "revers": [11, 12], "reflect": [11, 17], "underli": 11, "hierarchi": [11, 12], "One": 11, "observ": [11, 13], "term": 11, "equat": 11, "express": 11, "instead": [6, 11, 19], "affect": [11, 17, 18], "interact": [11, 18], "indirect": 11, "consid": [11, 13], "theta_": [11, 12], "p_4": 11, "p_3": 11, "rightarrow": 11, "p_1": [11, 12], "appli": 11, "q": 11, "k": [11, 12, 18], "bigg": 11, "red": 11, "prod_": 11, "len": [11, 17, 18], "green": 11, "index": [11, 17, 18], "last": 11, "ignor": 11, "deal": 11, "formal": [11, 12], "develop": [11, 14, 16], "novel": [11, 22], "predefin": 11, "among": 11, "depict": 11, "arrow": 11, "repres": [11, 13], "theta_i": 11, "theta_j": 11, "j": 11, "nonoptim": [11, 12], "must": 11, "connect": 11, "reach": 11, "mygreen": 11, "mark": 11, "color": 11, "realiz": 11, "cdot": [11, 12, 18], "naiv": 11, "could": [11, 12], "computation": 11, "oner": 11, "o": 11, "allevi": 11, "issu": [11, 21], "rightmost": 11, "reduc": [11, 15, 17], "right": 11, "left": 11, "equival": 11, "travers": 11, "As": [6, 11, 13, 17, 18], "serv": 11, "written": [11, 12], "quad": [11, 12, 18, 22], "lambda": [11, 12, 22], "underset": [11, 12, 18, 22], "challeng": 11, "solut": [11, 21], "practic": [11, 13], "typic": 11, "small": [11, 17, 21], "significantli": 11, "potenti": [6, 11, 13, 17], "obtain": 11, "until": 11, "converg": 11, "procedur": [11, 16, 18, 19], "alon": 11, "few": [6, 11], "dai": 11, "even": 11, "week": 11, "imagenet": 11, "bert": [11, 17], "dw": 11, "popularli": 11, "either": 11, "extens": 11, "studi": [11, 12, 17, 22], "bilevel": [6, 11, 12, 18], "literatur": 11, "grazzi": 11, "et": [11, 12], "al": [11, 12], "franceschi": [11, 12], "liu": [11, 12], "lorrain": [11, 12], "maclaurin": 11, "interest": [11, 13, 16], "reader": [6, 11], "insight": 11, "about": 11, "roughli": [11, 13], "speak": 11, "wherea": 11, "same": [6, 11], "theoret": 11, "analysi": 11, "ji": 11, "moreov": [11, 13], "benefit": [11, 18], "compar": [11, 18], "thu": [11, 13, 18, 19], "primarili": 11, "avail": 11, "finn": [11, 12], "neumann": [11, 22], "seri": 11, "conjug": 11, "rajeswaran": 11, "finit": [11, 18], "whichev": [11, 13, 16], "most": [6, 11, 13, 18, 21], "appropri": 11, "accomplish": 11, "task": [6, 11, 12, 18], "lot": 11, "network": [6, 11, 13, 17, 18, 19], "multipli": 11, "matric": 11, "uniqu": 11, "constraint": 11, "criteria": [11, 12], "singl": [11, 17, 18], "furthermor": [11, 13, 18], "those": 11, "known": 12, "definit": 12, "p": [12, 13], "said": 12, "argument": [12, 13], "min_": 12, "field": 12, "satisfi": 12, "a1": 12, "a2": 12, "p_n": 12, "theta_n": 12, "_n": 12, "rhd": 12, "hspace": 12, "8mm": 12, "ddot": 12, "9mm": 12, "2mm": 12, "ldot": 12, "23mm": 12, "24mm": 12, "theta_1": 12, "_1": 12, "stand": 12, "indic": 12, "should": [6, 12, 13, 14, 16, 18, 19, 22], "subseteq": 12, "although": 12, "denot": [12, 13, 18], "per": 12, "fact": 12, "henceforth": 12, "discard": 12, "assum": [6, 12, 13], "p_2": 12, "sort": 12, "uppermost": [12, 18], "lowermost": [12, 13, 18], "machin": 12, "limit": [12, 21], "maml": [6, 12], "hpo": 12, "na": 12, "rl": 12, "konda": 12, "actor": 12, "critic": 12, "simplest": [12, 18], "under": [12, 13, 22], "notat": 12, "c_2": 12, "theta_2": 12, "u_2": 12, "l_2": 12, "d_2": 12, "c_1": 12, "u_1": 12, "l_1": 12, "d_1": 12, "ce": 12, "init_weight": 12, "emptyset": 12, "omniglot_meta": 12, "omniglot_train": 12, "ptb_valid": 12, "lstm": 12, "ptb_train": 12, "cifar_valid": 12, "cnn": [6, 12], "cifar_train": 12, "built": 12, "upon": [12, 16], "recent": [12, 17, 21], "effort": 12, "beyond": 12, "raghu": 12, "trilevel": 12, "combin": [12, 18], "conduct": 12, "joint": 12, "over": 12, "consist": [12, 18], "approach": 12, "deeper": [12, 13], "instanc": 12, "Such": [6, 12], "garg": 12, "break": 13, "down": 13, "usag": [13, 17], "shown": [6, 13, 17], "my_modul": 13, "my_optim": 13, "my_data_load": 13, "problem_setup": 13, "myproblem": 13, "loss_fn": 13, "other_prob": 13, "get_accuraci": 13, "first_ord": 13, "prob": 13, "dive": [6, 13, 18], "categor": 13, "paradigm": 13, "separ": [6, 13], "respecitv": 13, "highli": [6, 13], "commonli": 13, "normal": [13, 17, 18, 21], "dataload": [13, 17, 18], "core": 13, "don": [13, 16, 18], "specifii": 13, "them": [13, 18], "thei": [13, 16, 19, 22], "avoid": 13, "prone": 13, "cumbersom": 13, "provis": 13, "manual": [13, 18], "imag": [13, 15, 18], "tool": [13, 16], "tensorboard": [13, 16], "standard": 13, "stream": 13, "termin": [13, 16], "inspir": 13, "lightn": 13, "choic": 13, "lack": 13, "your": [13, 18, 20], "problem1": 13, "prob1": 13, "problem2": 13, "prob2": 13, "callback": 13, "clamp": 13, "document": 13, "myengin": 13, "val_loss": 13, "test_load": 13, "val_acc": 13, "acc_fn": 13, "p1": [6, 13], "p2": [6, 13], "look": 13, "section": 13, "determin": [13, 18], "mention": 13, "want": [13, 16, 18, 19], "repeatedli": 13, "summar": 13, "varieti": 13, "profici": 13, "9": [14, 17, 18], "12": 14, "ml": [14, 16], "addition": 14, "functorch": 14, "11": [14, 19], "git": 14, "clone": 14, "http": 14, "github": 14, "com": 14, "leopard": 14, "ai": 14, "cd": 14, "test_instal": 14, "py": [14, 21, 22], "wa": 14, "success": 14, "yyyi": 14, "mm": 14, "dd": 14, "hh": 14, "ss": 14, "inform": [14, 16, 18, 19, 21], "spent": [14, 16, 18, 19], "001": 14, "1000": [14, 17, 18], "3682613968849182": 14, "2000": 14, "20": [14, 16, 18, 19], "30229413509368896": 14, "3000": [14, 16, 18, 19, 21], "30": [14, 16], "29078295826911926": 14, "4000": 14, "40": 14, "29050588607788086": 14, "50": [14, 18], "29037463665008545": 14, "hello": 14, "world": 14, "tail": [15, 17, 18], "throughout": [6, 15, 18], "quick": [6, 15, 16, 17, 19], "gpu": [15, 17], "footprint": 15, "monitor": 16, "flexibli": 16, "hasattr": [6, 16, 19], "disabl": 16, "reweight_config": [16, 17, 18], "2022": [16, 18, 19], "06": [16, 18, 19], "13": [16, 18, 19], "52": 16, "21": 16, "24": 16, "126": 16, "27": 16, "9833700656890869": 16, "72": 16, "99999594688416": 16, "39999999999999": 16, "200": [16, 18, 19], "5147801637649536": 16, "88": [16, 19], "99999856948853": 16, "85": [16, 19], "22": 16, "32": [16, 17], "300": [16, 19], "4090099036693573": 16, "87": 16, "99999952316284": 16, "33": 16, "89": 16, "31": 16, "35": 16, "400": [16, 19], "6072959899902344": 16, "99999761581421": 16, "36": 16, "90": 16, "88000000000001": 16, "38": 16, "500": [6, 16, 19], "32159245014190674": 16, "93": 16, "00000071525574": 16, "39": 16, "41": [16, 18], "logger_typ": 16, "result": [6, 16], "betty_tensorboard": 16, "open": 16, "logdir": 16, "visualizaiton": 16, "tend": 17, "trend": [17, 21], "transform": [17, 18], "gpt": 17, "strive": 17, "variou": [6, 17, 21], "half": 17, "precis": [17, 21], "analyz": 17, "effect": 17, "resnet50": 17, "relev": [17, 18], "copi": [17, 18], "past": [17, 18], "collaps": 17, "snippet": 17, "torchvis": [17, 18], "cuda": [17, 18], "is_avail": [17, 18], "els": [17, 18], "cpu": [17, 18], "build_dataset": [17, 18], "reweight_s": [17, 18], "255": 17, "125": 17, "123": 17, "113": 17, "std": 17, "63": 17, "62": 17, "66": 17, "randomcrop": 17, "pad": 17, "padding_mod": 17, "randomhorizontalflip": 17, "totensor": [17, 18], "root": [6, 17, 18], "download": [17, 18], "num_class": [17, 18], "num_meta": [17, 18], "index_to_meta": [17, 18], "index_to_train": [17, 18], "imbalanced_num_list": [17, 18], "sample_num": [17, 18], "class_index": [17, 18], "imbalanced_num": [17, 18], "append": [6, 17, 18], "np": [6, 17, 18], "random": [17, 18], "shuffl": [17, 18], "index_to_class": [17, 18], "enumer": [17, 18], "extend": [17, 18], "index_to_class_for_train": [17, 18], "reweight_dataset": [17, 18], "deepcopi": [17, 18], "arrai": [17, 18], "classifier_dataset": [17, 18], "valid_transform": 17, "valid_dataset": [17, 18], "valid_dataload": [17, 18], "batch_siz": [17, 18], "pin_memori": [17, 18], "bottleneck": [17, 21], "expans": 17, "__init__": [6, 17, 22], "in_plan": 17, "plane": 17, "stride": 17, "super": [6, 17], "conv1": 17, "conv2d": 17, "kernel_s": 17, "bia": 17, "bn1": 17, "batchnorm2d": 17, "conv2": 17, "bn2": 17, "conv3": 17, "bn3": 17, "shortcut": 17, "sequenti": [17, 18], "relu": [17, 18], "resnet": 17, "num_block": 17, "64": [17, 19], "layer1": 17, "_make_lay": 17, "layer2": 17, "128": 17, "layer3": 17, "256": 17, "layer4": 17, "512": 17, "linear": [17, 18], "layer": [17, 18], "avg_pool2d": 17, "view": 17, "classifier_modul": [17, 18], "mini": 17, "gradient_accumul": [6, 17], "full": [6, 17, 18], "instabl": 17, "split": 18, "therebi": [], "speed": [], "ablat": 17, "memroi": 17, "tabl": [17, 18], "baselin": [17, 18], "6817mib": 17, "4397mib": 17, "3185": [], "3077mib": [], "report": 17, "context": 18, "mitig": [18, 21], "imbal": 18, "assign": 18, "rare": 18, "mwn": 18, "r": 18, "i_": 18, "befor": 18, "imbalanc": 18, "factor": 18, "least": 18, "part": [6, 18, 20, 22], "prepar": 18, "numpi": 18, "mnist": 18, "1307": 18, "3081": 18, "creat": [18, 22], "everyth": 18, "except": 18, "guid": 18, "adopt": 18, "flatten": 18, "784": 18, "classifier_optim": 18, "classifier_dataload": 18, "classifier_schedul": 18, "1500": 18, "2500": 18, "overcom": 18, "increas": 18, "decreas": 18, "line": 18, "awar": 18, "mani": 18, "classifier_config": 18, "hidden": 18, "reweight_modul": 18, "sigmoid": 18, "reweight_optim": 18, "1e": [6, 18], "reweight_dataload": 18, "balanc": 18, "recal": [18, 22], "categori": 18, "alreadi": [6, 18], "000": 18, "pre": 18, "accord": 18, "link": 18, "correctli": [18, 19], "someth": 18, "screen": 18, "01": 18, "48": 18, "51": 18, "124": 18, "95": 18, "91": [18, 19], "82": [18, 19], "show": [6, 18], "clearli": 18, "happi": 18, "intention": 19, "reus": 19, "custom": [6, 19, 20, 22], "expect": 19, "29": 19, "08": 19, "099": 19, "81": 19, "25": [6, 19], "14": 19, "44": 19, "17": 19, "53": 19, "67": 19, "23": 19, "26": 19, "despit": 21, "popular": 21, "research": [21, 22], "hessian": 21, "emerg": 21, "natur": 21, "keep": 21, "foundat": 21, "seamless": [], "launch": [], "script": [], "local_rank": 21, "nproc_per_nod": 21, "num_gpu": 21, "nnode": 21, "num_nod": 21, "node_rank": 21, "master_addr": 21, "master_port": 21, "your_training_script": [], "scene": 21, "care": 21, "sampler": [], "chang": [21, 22], "file": 22, "directori": 22, "own": 22, "2ex": 22, "new_hypergrad": 22, "myhypergrad": 22, "whose": 22, "matrix_vector_multiplication_with_best_response_jacobian": 22, "jvp_fn_map": 22, "myhypergrad_nam": 22, "strategi": 21, "ddp": [4, 21], "redund": 21, "importantli": 21, "featuer": 21, "liner": 21, "elast": 21, "launcher": 21, "torchrun": 21, "mulitpl": 21, "v0": 21, "stabli": 21, "distributeddataparallel": [], "zeroredundancyoptim": [], "experiment": 21, "fulli": 21, "shard": 21, "fullyshardeddataparallel": [], "org": [], "doc": [], "stabl": [], "html": [], "master": [], "prefer": 21, "job": 21, "instruct": 21, "offici": 21, "geq": 21, "simpl": 21, "train_script": 21, "use_env": 21, "rdzv_backend": 21, "c10d": 21, "rdzv_endpoint": 21, "argpars": 21, "parser": 21, "argumentpars": 21, "add_argu": 21, "parse_arg": 21, "mix": 21, "configure_system": 0, "basic": 0, "system": [0, 4], "extra_config": 4, "epoch_callback_exec": 4, "patch_data_load": 4, "patch_everyth": 4, "set_modul": 4, "set_optim": 4, "set_schedul": 4, "set_train_data_load": 4, "convolut": 6, "shot": 6, "post": 6, "mainli": 6, "blog": 6, "modif": 6, "just": 6, "initiazli": 6, "principl": 6, "decoupl": 6, "bi": 6, "coupl": 6, "unfortun": 6, "hard": 6, "ugli": 6, "clean": 6, "entangl": 6, "learn2learn": 6, "l2l": 6, "taskset": 6, "vision": 6, "benchmark": 6, "get_taskset": 6, "train_wai": 6, "train_sampl": 6, "test_wai": 6, "test_sampl": 6, "num_task": 6, "task_num": 6, "split_data": 6, "adapt_indic": 6, "dtype": 6, "arang": 6, "eval_indic": 6, "from_numpi": 6, "mamlenv": 6, "grant": 6, "meta_batch_s": 6, "amount": 6, "rest": 6, "rel": 6, "who": 6, "unfamiliar": 6, "parent_modul": 6, "convnet": 6, "parent_optim": 6, "3e": 6, "parent_schedul": 6, "cosineannealinglr": 6, "t_max": 6, "parent_config": 6, "inner_step": 6, "offer": 6, "on_inner_loop_start": 6, "reg_loss": 6, "reference_paramet": 6, "reg_lambda": 6, "zip": 6, "pow": 6, "reg": 6, "child_modul": 6, "model_cl": 6, "child_optim": 6, "child_config": 6, "illustru": 6, "coordin": 6, "mamlengin": 6, "leav": 6, "test_net": 6, "test_optim": 6, "train_input": 6, "train_label": 6, "test_input": 6, "test_label": 6, "cat": 6, "tri": 6}, "objects": {"betty": [[0, 0, 0, "-", "engine"], [3, 0, 0, "-", "optim"]], "betty.engine": [[0, 1, 1, "", "Engine"]], "betty.engine.Engine": [[0, 2, 1, "", "check_leaf"], [0, 2, 1, "", "configure_systems"], [0, 2, 1, "", "do_validation"], [0, 2, 1, "", "eval"], [0, 2, 1, "", "find_paths"], [0, 2, 1, "", "initialize"], [0, 2, 1, "", "is_implemented"], [0, 2, 1, "", "is_rank_zero"], [0, 2, 1, "", "parse_config"], [0, 2, 1, "", "parse_dependency"], [0, 2, 1, "", "run"], [0, 2, 1, "", "set_dependency"], [0, 2, 1, "", "set_problem_attr"], [0, 2, 1, "", "train"], [0, 2, 1, "", "train_step"]], "betty.hypergradient": [[1, 0, 0, "-", "cg"], [1, 0, 0, "-", "darts"], [1, 0, 0, "-", "neumann"], [1, 0, 0, "-", "reinforce"]], "betty.hypergradient.cg": [[1, 3, 1, "", "cg"]], "betty.hypergradient.darts": [[1, 3, 1, "", "darts"]], "betty.hypergradient.neumann": [[1, 3, 1, "", "neumann"]], "betty.hypergradient.reinforce": [[1, 3, 1, "", "reinforce"]], "betty.logging": [[2, 0, 0, "-", "logger_base"], [2, 0, 0, "-", "logger_tensorboard"], [2, 0, 0, "-", "logger_wandb"]], "betty.logging.logger_base": [[2, 1, 1, "", "LoggerBase"], [2, 3, 1, "", "get_logger"]], "betty.logging.logger_base.LoggerBase": [[2, 2, 1, "", "debug"], [2, 2, 1, "", "error"], [2, 2, 1, "", "info"], [2, 2, 1, "", "log"], [2, 2, 1, "", "warning"]], "betty.logging.logger_tensorboard": [[2, 1, 1, "", "TensorBoardLogger"]], "betty.logging.logger_tensorboard.TensorBoardLogger": [[2, 2, 1, "", "close"], [2, 2, 1, "", "log"]], "betty.logging.logger_wandb": [[2, 1, 1, "", "WandBLogger"]], "betty.logging.logger_wandb.WandBLogger": [[2, 2, 1, "", "log"]], "betty.optim": [[3, 0, 0, "-", "adam"], [3, 0, 0, "-", "adamw"], [3, 3, 1, "", "patch_optimizer"], [3, 3, 1, "", "patch_scheduler"], [3, 0, 0, "-", "sgd"]], "betty.optim.adam": [[3, 1, 1, "", "DifferentiableAdam"]], "betty.optim.adamw": [[3, 1, 1, "", "DifferentiableAdamW"]], "betty.optim.sgd": [[3, 1, 1, "", "DifferentiableSGD"]], "betty.problems": [[4, 0, 0, "-", "implicit_problem"], [4, 0, 0, "-", "iterative_problem"], [4, 0, 0, "-", "problem"]], "betty.problems.implicit_problem": [[4, 1, 1, "", "ImplicitProblem"]], "betty.problems.iterative_problem": [[4, 1, 1, "", "IterativeProblem"]], "betty.problems.iterative_problem.IterativeProblem": [[4, 2, 1, "", "patch_modules"], [4, 2, 1, "", "patch_optimizer"], [4, 2, 1, "", "patch_scheduler"]], "betty.problems.problem": [[4, 1, 1, "", "Problem"]], "betty.problems.problem.Problem": [[4, 2, 1, "", "add_child"], [4, 2, 1, "", "add_env"], [4, 2, 1, "", "add_logger"], [4, 2, 1, "", "add_parent"], [4, 2, 1, "", "add_paths"], [4, 2, 1, "", "backward"], [4, 2, 1, "", "cache_states"], [4, 2, 1, "", "check_ready"], [4, 4, 1, "", "children"], [4, 2, 1, "", "clear_dependencies"], [4, 2, 1, "", "clip_grad"], [4, 4, 1, "", "config"], [4, 2, 1, "", "configure_device"], [4, 2, 1, "", "configure_distributed_training"], [4, 2, 1, "", "configure_roll_back"], [4, 4, 1, "", "count"], [4, 2, 1, "", "epoch_callback_exec"], [4, 2, 1, "", "eval"], [4, 2, 1, "", "forward"], [4, 2, 1, "", "get_batch"], [4, 2, 1, "", "get_batch_single_loader"], [4, 2, 1, "", "get_loss"], [4, 2, 1, "", "get_opt_param_group_for_param"], [4, 2, 1, "", "get_opt_state_for_param"], [4, 2, 1, "", "gradient_accumulation_boundary"], [4, 2, 1, "", "initialize"], [4, 2, 1, "", "is_implemented"], [4, 2, 1, "", "is_rank_zero"], [4, 4, 1, "", "leaf"], [4, 2, 1, "", "load_state_dict"], [4, 2, 1, "", "log"], [4, 4, 1, "", "name"], [4, 2, 1, "", "one_step_descent"], [4, 2, 1, "", "optimizer_step"], [4, 2, 1, "", "parameters"], [4, 4, 1, "", "parents"], [4, 2, 1, "", "patch_data_loader"], [4, 2, 1, "", "patch_everything"], [4, 2, 1, "", "patch_module"], [4, 2, 1, "", "patch_optimizer"], [4, 2, 1, "", "patch_scheduler"], [4, 4, 1, "", "paths"], [4, 2, 1, "", "recover_states"], [4, 2, 1, "", "set_grads"], [4, 2, 1, "", "set_module"], [4, 2, 1, "", "set_optimizer"], [4, 2, 1, "", "set_scheduler"], [4, 2, 1, "", "set_train_data_loader"], [4, 2, 1, "", "state_dict"], [4, 2, 1, "", "step"], [4, 2, 1, "", "step_after_roll_back"], [4, 2, 1, "", "step_normal"], [4, 2, 1, "", "synchronize_params"], [4, 2, 1, "", "train"], [4, 2, 1, "", "trainable_parameters"], [4, 2, 1, "", "training_step"], [4, 2, 1, "", "training_step_exec"], [4, 2, 1, "", "zero_grad"]]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:method", "3": "py:function", "4": "py:property"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "method", "Python method"], "3": ["py", "function", "Python function"], "4": ["py", "property", "Python property"]}, "titleterms": {"betti": [0, 1, 2, 3, 4, 5, 8], "engin": [0, 5, 6, 13, 18], "hypergradi": [1, 22], "finit": 1, "differ": 1, "neumann": 1, "seri": 1, "conjug": 1, "gradient": [1, 11, 17], "reinforc": 1, "log": [2, 16], "packag": 2, "tensorboard": 2, "logger": 2, "wandb": 2, "base": 2, "optim": [3, 11, 12, 13, 17], "support": 3, "problem": [4, 5, 13, 18], "implicit": [4, 6], "iter": 4, "data": [5, 13], "reweight": [5, 18], "introduct": [5, 8], "cours": 5, "action": 5, "prepar": 5, "design": [5, 13], "model": [5, 6], "us": 5, "defin": 5, "conclus": 5, "neural": 7, "architectur": [7, 10], "search": 7, "document": 8, "benefit": 8, "applic": [8, 12], "get": 8, "start": [8, 18], "major": 9, "concept": 9, "autodiff": 11, "multilevel": [11, 12], "dataflow": 11, "graph": 11, "calcul": 11, "best": 11, "respons": 11, "jacobian": 11, "exampl": 12, "softwar": 13, "0": 13, "type": 13, "1": 13, "modul": 13, "2": 13, "3": 13, "loader": 13, "4": 13, "upper": [6, 13, 18], "lower": [6, 13, 18], "constrain": 13, "set": 13, "5": 13, "loss": 13, "function": 13, "6": 13, "configur": 13, "7": 13, "name": 13, "8": 13, "other": 13, "option": 13, "compon": 13, "depend": 13, "valid": [13, 19], "run": 13, "instal": 14, "pip": 14, "verifi": 14, "basic": [6, 15, 18], "visual": 16, "memori": 17, "setup": [17, 18], "accumul": 17, "fp16": 17, "train": [17, 21], "non": [], "distribut": 21, "parallel": [], "result": [17, 18], "quick": 18, "level": [6, 18], "classifi": 18, "intermedi": 20, "engineconfig": 21, "launch": 21, "agnost": 6, "meta": 6, "learn": 6, "environ": 6}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx.ext.todo": 2, "sphinx.ext.viewcode": 1, "sphinx": 57}, "alltitles": {"betty.engine": [[0, "betty-engine"]], "Engine": [[0, "module-betty.engine"], [6, "engine"], [13, "engine"], [18, "engine"]], "betty.hypergradient": [[1, "betty-hypergradient"]], "finite difference": [[1, "module-betty.hypergradient.darts"]], "neumann series": [[1, "module-betty.hypergradient.neumann"]], "conjugate gradient": [[1, "module-betty.hypergradient.cg"]], "reinforce": [[1, "module-betty.hypergradient.reinforce"]], "betty.logging package": [[2, "betty-logging-package"]], "Tensorboard Logger": [[2, "module-betty.logging.logger_tensorboard"]], "WandB Logger": [[2, "module-betty.logging.logger_wandb"]], "Base Logger": [[2, "module-betty.logging.logger_base"]], "betty.optim": [[3, "betty-optim"]], "Supported optimizers": [[3, "supported-optimizers"]], "betty.problems": [[4, "betty-problems"]], "Problem": [[4, "module-betty.problems.problem"], [13, "problem"], [18, "problem"]], "Implicit Problem": [[4, "implicit-problem"]], "Iterative Problem": [[4, "iterative-problem"]], "Data Reweighting": [[5, "data-reweighting"]], "Introduction": [[5, "introduction"], [8, "introduction"]], "Course of Action": [[5, "course-of-action"]], "Preparing Data": [[5, "preparing-data"]], "Designing Models": [[5, "designing-models"]], "Using Betty": [[5, "using-betty"]], "Defining Problem": [[5, "defining-problem"]], "Defining Engine": [[5, "defining-engine"]], "Conclusion": [[5, "conclusion"]], "Implicit Model Agnostic Meta-Learning": [[6, "implicit-model-agnostic-meta-learning"]], "Basics": [[6, "basics"]], "Environment": [[6, "environment"]], "Upper-Level": [[6, "upper-level"]], "Lower-Level": [[6, "lower-level"]], "Neural Architecture Search": [[7, "neural-architecture-search"]], "Betty Documentation": [[8, "betty-documentation"]], "Benefits": [[8, "benefits"]], "Applications": [[8, "applications"]], "Getting Started": [[8, "getting-started"]], "Major Concepts": [[9, "major-concepts"]], "Architecture": [[10, "architecture"]], "Autodiff for Multilevel Optimization": [[11, "autodiff-for-multilevel-optimization"]], "Dataflow Graph for Multilevel Optimization": [[11, "dataflow-graph-for-multilevel-optimization"]], "Gradient Calculation with Best-Response Jacobian": [[11, "gradient-calculation-with-best-response-jacobian"]], "Multilevel Optimization": [[12, "multilevel-optimization"]], "Application Examples": [[12, "application-examples"]], "Software Design": [[13, "software-design"]], "(0) Problem type": [[13, "problem-type"]], "(1) Module": [[13, "module"]], "(2) Optimizer": [[13, "optimizer"]], "(3) Data loader": [[13, "data-loader"]], "(4) Upper & Lower Constraining Problem Sets": [[13, "upper-lower-constraining-problem-sets"]], "(5) Loss function": [[13, "loss-function"]], "(6) Optimization Configuration": [[13, "optimization-configuration"]], "(7) Name": [[13, "name"]], "(8) Other Optional Components": [[13, "other-optional-components"]], "(1) Problems": [[13, "problems"]], "(2) Dependencies": [[13, "dependencies"]], "(3) Validation": [[13, "validation"]], "(4) Engine Configuration": [[13, "engine-configuration"]], "(5) Run": [[13, "run"]], "Installation": [[14, "installation"]], "Install with pip": [[14, "install-with-pip"]], "Verifying Installation": [[14, "verifying-installation"]], "Basic": [[15, "basic"]], "Logging": [[16, "logging"]], "Visualization": [[16, "visualization"]], "Memory Optimization": [[17, "memory-optimization"]], "Setup": [[17, "setup"]], "Gradient Accumulation": [[17, "gradient-accumulation"]], "FP16 Training": [[17, "fp16-training"]], "Memory optimization results": [[17, "memory-optimization-results"]], "Quick Start": [[18, "quick-start"]], "Basic setup": [[18, "basic-setup"]], "Lower-level Problem (Classifier)": [[18, "lower-level-problem-classifier"]], "Upper-level Problem (Reweight)": [[18, "upper-level-problem-reweight"]], "Results": [[18, "results"]], "Validation": [[19, "validation"]], "Intermediate": [[20, "intermediate"]], "Distributed Training": [[21, "distributed-training"]], "EngineConfig": [[21, "engineconfig"]], "Launch": [[21, "launch"]], "Hypergradient": [[22, "hypergradient"]]}, "indexentries": {"engine (class in betty.engine)": [[0, "betty.engine.Engine"]], "betty.engine": [[0, "module-betty.engine"]], "check_leaf() (betty.engine.engine method)": [[0, "betty.engine.Engine.check_leaf"]], "configure_systems() (betty.engine.engine method)": [[0, "betty.engine.Engine.configure_systems"]], "do_validation() (betty.engine.engine method)": [[0, "betty.engine.Engine.do_validation"]], "eval() (betty.engine.engine method)": [[0, "betty.engine.Engine.eval"]], "find_paths() (betty.engine.engine method)": [[0, "betty.engine.Engine.find_paths"]], "initialize() (betty.engine.engine method)": [[0, "betty.engine.Engine.initialize"]], "is_implemented() (betty.engine.engine method)": [[0, "betty.engine.Engine.is_implemented"]], "is_rank_zero() (betty.engine.engine method)": [[0, "betty.engine.Engine.is_rank_zero"]], "module": [[0, "module-betty.engine"], [1, "module-betty.hypergradient.cg"], [1, "module-betty.hypergradient.darts"], [1, "module-betty.hypergradient.neumann"], [1, "module-betty.hypergradient.reinforce"], [2, "module-betty.logging.logger_base"], [2, "module-betty.logging.logger_tensorboard"], [2, "module-betty.logging.logger_wandb"], [3, "module-betty.optim"], [3, "module-betty.optim.adam"], [3, "module-betty.optim.adamw"], [3, "module-betty.optim.sgd"], [4, "module-betty.problems.implicit_problem"], [4, "module-betty.problems.iterative_problem"], [4, "module-betty.problems.problem"]], "parse_config() (betty.engine.engine method)": [[0, "betty.engine.Engine.parse_config"]], "parse_dependency() (betty.engine.engine method)": [[0, "betty.engine.Engine.parse_dependency"]], "run() (betty.engine.engine method)": [[0, "betty.engine.Engine.run"]], "set_dependency() (betty.engine.engine method)": [[0, "betty.engine.Engine.set_dependency"]], "set_problem_attr() (betty.engine.engine method)": [[0, "betty.engine.Engine.set_problem_attr"]], "train() (betty.engine.engine method)": [[0, "betty.engine.Engine.train"]], "train_step() (betty.engine.engine method)": [[0, "betty.engine.Engine.train_step"]], "betty.hypergradient.cg": [[1, "module-betty.hypergradient.cg"]], "betty.hypergradient.darts": [[1, "module-betty.hypergradient.darts"]], "betty.hypergradient.neumann": [[1, "module-betty.hypergradient.neumann"]], "betty.hypergradient.reinforce": [[1, "module-betty.hypergradient.reinforce"]], "cg() (in module betty.hypergradient.cg)": [[1, "betty.hypergradient.cg.cg"]], "darts() (in module betty.hypergradient.darts)": [[1, "betty.hypergradient.darts.darts"]], "neumann() (in module betty.hypergradient.neumann)": [[1, "betty.hypergradient.neumann.neumann"]], "reinforce() (in module betty.hypergradient.reinforce)": [[1, "betty.hypergradient.reinforce.reinforce"]], "loggerbase (class in betty.logging.logger_base)": [[2, "betty.logging.logger_base.LoggerBase"]], "tensorboardlogger (class in betty.logging.logger_tensorboard)": [[2, "betty.logging.logger_tensorboard.TensorBoardLogger"]], "wandblogger (class in betty.logging.logger_wandb)": [[2, "betty.logging.logger_wandb.WandBLogger"]], "betty.logging.logger_base": [[2, "module-betty.logging.logger_base"]], "betty.logging.logger_tensorboard": [[2, "module-betty.logging.logger_tensorboard"]], "betty.logging.logger_wandb": [[2, "module-betty.logging.logger_wandb"]], "close() (betty.logging.logger_tensorboard.tensorboardlogger method)": [[2, "betty.logging.logger_tensorboard.TensorBoardLogger.close"]], "debug() (betty.logging.logger_base.loggerbase static method)": [[2, "betty.logging.logger_base.LoggerBase.debug"]], "error() (betty.logging.logger_base.loggerbase static method)": [[2, "betty.logging.logger_base.LoggerBase.error"]], "get_logger() (in module betty.logging.logger_base)": [[2, "betty.logging.logger_base.get_logger"]], "info() (betty.logging.logger_base.loggerbase static method)": [[2, "betty.logging.logger_base.LoggerBase.info"]], "log() (betty.logging.logger_base.loggerbase method)": [[2, "betty.logging.logger_base.LoggerBase.log"]], "log() (betty.logging.logger_tensorboard.tensorboardlogger method)": [[2, "betty.logging.logger_tensorboard.TensorBoardLogger.log"]], "log() (betty.logging.logger_wandb.wandblogger method)": [[2, "betty.logging.logger_wandb.WandBLogger.log"]], "warning() (betty.logging.logger_base.loggerbase static method)": [[2, "betty.logging.logger_base.LoggerBase.warning"]], "differentiableadam (class in betty.optim.adam)": [[3, "betty.optim.adam.DifferentiableAdam"]], "differentiableadamw (class in betty.optim.adamw)": [[3, "betty.optim.adamw.DifferentiableAdamW"]], "differentiablesgd (class in betty.optim.sgd)": [[3, "betty.optim.sgd.DifferentiableSGD"]], "betty.optim": [[3, "module-betty.optim"]], "betty.optim.adam": [[3, "module-betty.optim.adam"]], "betty.optim.adamw": [[3, "module-betty.optim.adamw"]], "betty.optim.sgd": [[3, "module-betty.optim.sgd"]], "patch_optimizer() (in module betty.optim)": [[3, "betty.optim.patch_optimizer"]], "patch_scheduler() (in module betty.optim)": [[3, "betty.optim.patch_scheduler"]], "implicitproblem (class in betty.problems.implicit_problem)": [[4, "betty.problems.implicit_problem.ImplicitProblem"]], "iterativeproblem (class in betty.problems.iterative_problem)": [[4, "betty.problems.iterative_problem.IterativeProblem"]], "problem (class in betty.problems.problem)": [[4, "betty.problems.problem.Problem"]], "add_child() (betty.problems.problem.problem method)": [[4, "betty.problems.problem.Problem.add_child"]], "add_env() (betty.problems.problem.problem method)": [[4, "betty.problems.problem.Problem.add_env"]], "add_logger() (betty.problems.problem.problem method)": [[4, "betty.problems.problem.Problem.add_logger"]], "add_parent() (betty.problems.problem.problem method)": [[4, "betty.problems.problem.Problem.add_parent"]], "add_paths() (betty.problems.problem.problem method)": [[4, "betty.problems.problem.Problem.add_paths"]], "backward() (betty.problems.problem.problem method)": [[4, "betty.problems.problem.Problem.backward"]], "betty.problems.implicit_problem": [[4, "module-betty.problems.implicit_problem"]], "betty.problems.iterative_problem": [[4, "module-betty.problems.iterative_problem"]], "betty.problems.problem": [[4, "module-betty.problems.problem"]], "cache_states() (betty.problems.problem.problem method)": [[4, "betty.problems.problem.Problem.cache_states"]], "check_ready() (betty.problems.problem.problem method)": [[4, "betty.problems.problem.Problem.check_ready"]], "children (betty.problems.problem.problem property)": [[4, "betty.problems.problem.Problem.children"]], "clear_dependencies() (betty.problems.problem.problem method)": [[4, "betty.problems.problem.Problem.clear_dependencies"]], "clip_grad() (betty.problems.problem.problem method)": [[4, "betty.problems.problem.Problem.clip_grad"]], "config (betty.problems.problem.problem property)": [[4, "betty.problems.problem.Problem.config"]], "configure_device() (betty.problems.problem.problem method)": [[4, "betty.problems.problem.Problem.configure_device"]], "configure_distributed_training() (betty.problems.problem.problem method)": [[4, "betty.problems.problem.Problem.configure_distributed_training"]], "configure_roll_back() (betty.problems.problem.problem method)": [[4, "betty.problems.problem.Problem.configure_roll_back"]], "count (betty.problems.problem.problem property)": [[4, "betty.problems.problem.Problem.count"]], "epoch_callback_exec() (betty.problems.problem.problem method)": [[4, "betty.problems.problem.Problem.epoch_callback_exec"]], "eval() (betty.problems.problem.problem method)": [[4, "betty.problems.problem.Problem.eval"]], "forward() (betty.problems.problem.problem method)": [[4, "betty.problems.problem.Problem.forward"]], "get_batch() (betty.problems.problem.problem method)": [[4, "betty.problems.problem.Problem.get_batch"]], "get_batch_single_loader() (betty.problems.problem.problem method)": [[4, "betty.problems.problem.Problem.get_batch_single_loader"]], "get_loss() (betty.problems.problem.problem method)": [[4, "betty.problems.problem.Problem.get_loss"]], "get_opt_param_group_for_param() (betty.problems.problem.problem method)": [[4, "betty.problems.problem.Problem.get_opt_param_group_for_param"]], "get_opt_state_for_param() (betty.problems.problem.problem method)": [[4, "betty.problems.problem.Problem.get_opt_state_for_param"]], "gradient_accumulation_boundary() (betty.problems.problem.problem method)": [[4, "betty.problems.problem.Problem.gradient_accumulation_boundary"]], "initialize() (betty.problems.problem.problem method)": [[4, "betty.problems.problem.Problem.initialize"]], "is_implemented() (betty.problems.problem.problem method)": [[4, "betty.problems.problem.Problem.is_implemented"]], "is_rank_zero() (betty.problems.problem.problem method)": [[4, "betty.problems.problem.Problem.is_rank_zero"]], "leaf (betty.problems.problem.problem property)": [[4, "betty.problems.problem.Problem.leaf"]], "load_state_dict() (betty.problems.problem.problem method)": [[4, "betty.problems.problem.Problem.load_state_dict"]], "log() (betty.problems.problem.problem method)": [[4, "betty.problems.problem.Problem.log"]], "name (betty.problems.problem.problem property)": [[4, "betty.problems.problem.Problem.name"]], "one_step_descent() (betty.problems.problem.problem method)": [[4, "betty.problems.problem.Problem.one_step_descent"]], "optimizer_step() (betty.problems.problem.problem method)": [[4, "betty.problems.problem.Problem.optimizer_step"]], "parameters() (betty.problems.problem.problem method)": [[4, "betty.problems.problem.Problem.parameters"]], "parents (betty.problems.problem.problem property)": [[4, "betty.problems.problem.Problem.parents"]], "patch_data_loader() (betty.problems.problem.problem method)": [[4, "betty.problems.problem.Problem.patch_data_loader"]], "patch_everything() (betty.problems.problem.problem method)": [[4, "betty.problems.problem.Problem.patch_everything"]], "patch_module() (betty.problems.problem.problem method)": [[4, "betty.problems.problem.Problem.patch_module"]], "patch_modules() (betty.problems.iterative_problem.iterativeproblem method)": [[4, "betty.problems.iterative_problem.IterativeProblem.patch_modules"]], "patch_optimizer() (betty.problems.iterative_problem.iterativeproblem method)": [[4, "betty.problems.iterative_problem.IterativeProblem.patch_optimizer"]], "patch_optimizer() (betty.problems.problem.problem method)": [[4, "betty.problems.problem.Problem.patch_optimizer"]], "patch_scheduler() (betty.problems.iterative_problem.iterativeproblem method)": [[4, "betty.problems.iterative_problem.IterativeProblem.patch_scheduler"]], "patch_scheduler() (betty.problems.problem.problem method)": [[4, "betty.problems.problem.Problem.patch_scheduler"]], "paths (betty.problems.problem.problem property)": [[4, "betty.problems.problem.Problem.paths"]], "recover_states() (betty.problems.problem.problem method)": [[4, "betty.problems.problem.Problem.recover_states"]], "set_grads() (betty.problems.problem.problem method)": [[4, "betty.problems.problem.Problem.set_grads"]], "set_module() (betty.problems.problem.problem method)": [[4, "betty.problems.problem.Problem.set_module"]], "set_optimizer() (betty.problems.problem.problem method)": [[4, "betty.problems.problem.Problem.set_optimizer"]], "set_scheduler() (betty.problems.problem.problem method)": [[4, "betty.problems.problem.Problem.set_scheduler"]], "set_train_data_loader() (betty.problems.problem.problem method)": [[4, "betty.problems.problem.Problem.set_train_data_loader"]], "state_dict() (betty.problems.problem.problem method)": [[4, "betty.problems.problem.Problem.state_dict"]], "step() (betty.problems.problem.problem method)": [[4, "betty.problems.problem.Problem.step"]], "step_after_roll_back() (betty.problems.problem.problem method)": [[4, "betty.problems.problem.Problem.step_after_roll_back"]], "step_normal() (betty.problems.problem.problem method)": [[4, "betty.problems.problem.Problem.step_normal"]], "synchronize_params() (betty.problems.problem.problem method)": [[4, "betty.problems.problem.Problem.synchronize_params"]], "train() (betty.problems.problem.problem method)": [[4, "betty.problems.problem.Problem.train"]], "trainable_parameters() (betty.problems.problem.problem method)": [[4, "betty.problems.problem.Problem.trainable_parameters"]], "training_step() (betty.problems.problem.problem method)": [[4, "betty.problems.problem.Problem.training_step"]], "training_step_exec() (betty.problems.problem.problem method)": [[4, "betty.problems.problem.Problem.training_step_exec"]], "zero_grad() (betty.problems.problem.problem method)": [[4, "betty.problems.problem.Problem.zero_grad"]]}})